<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Dropzone test</title>
	<style>
		body {
			font-family: Helvetica Neue, Helvetica, sans-serif;
			padding: 2em;
		}

		#dropzone {
			display: block;
			position: relative;
			border: 3px solid rgba(0,0,0,.3);
			height: 300px;
			overflow: hidden;
			clear: both;
		}
		.gallery-grid {
			display: block;
			clear: both;
		}
		.gallery-grid > li {
			display: inline-block;
			width: 20%;
			margin: 0 15px;
			padding: 0;
			margin-bottom: 24px;
			height: 200px;
			float: left;
		}
		.gallery-item {
			border: 1px solid silver;
			background: rgba(0,0,0,.4);
		}
		.dropzone {
			text-align: center;
		}
		.dropzone-success {
			border: 3px dashed green;
		}
		.dropzone-error {
			border: 3px dashed red;
		}
		.dropzone-progress {
			border: 3px dashed yellow;
		}
		.dropzone-progress > .progress-bar{
			background-color: yellow;
			height: 10px;
			width: 0%;
		}
		.dropzone-default {
			border: 3px dashed gray;
		}
		.dropzone-dragover {
			border: 3px dashed blue;
		}
		.dropzone-success,
		.dropzone-error,
		.dropzone-default,
		.dropzone-progress {
			display: none;
		}
		.dropzone.is-success .dropzone-success,
		.dropzone.is-error .dropzone-error,
		.dropzone.is-default .dropzone-default,
		.dropzone.is-progress .dropzone-progress {
			display: block;
		}

		.page-section {
			display: block;
			clear: both;
			margin-bottom: 24px;
		}
	</style>
</head>
<body>

	<h1>Dropzone test</h1>
	
	<div class="page-section">
		<ul class="gallery-grid">
			<li class="gallery-item">Block</li>
		</ul>
	</div>

	<div class="page-section">
		<div class="dropzone-placeholder js-second-dropzone-holder">
			
		</div>
		<ul class="js-second-list">
			<li>item</li>
		</ul>
	</div>

	
	<script src="build/build.js"></script>
	<script>
		var Dropzone = require('dropzone');
    	var dropOptions = {
    		uploadUrl: 'http://daidalos.apiary.io/image-block/image/upload',
    		uploadInputId: 'dropzone-fileupload'
    	}
    	var drop = new Dropzone('.gallery-grid', dropOptions);

		// set dropzone templates by one and without variables values
        drop.templateState('successState','<i class="icon-plus"></i><span>{{=it.successMsg}}</span>');
		drop.templateState('errorState','{{=it.errorMsg}}');
		
		// set the values for templates
		var stateTemplatesVars = {
			'errorState': {
				errorMsg: 'Error msg!'
			},
			'successState': {
				successMsg: 'Success!'
			}
		};
		
		// show dropzone in DOM using variables
		drop.show(stateTemplatesVars);

		// update template on visible dropzone but you must set variables too
		drop.templateState('defaultState','<strong>{{=it.defaultMsg}}</strong>', { defaultMsg: 'Ola!' });

		// update multiple teplates in one function of course also with variables
		drop.templateStates({
			'successState': {
				template: '<strong>{{=it.successMsg}}</strong>', 
				data: { successMsg: 'Yahoooo!' }
			},
			'progressState': {
				template: '<div class="progress-bar" style="width:{{=it.percent}}%;"></div>',
				data: { percent: 0 }
			}
		});


		//
		// Emitted events
		//

		drop.on('uploadBegin', function(){
			// Do something on upload begin
			console.log('Upload beginned');
		});

		drop.on('uploadProgress', function(){
			// Do something on upload progress
			console.log('Upload in progress');
		});

		drop.on('uploadError', function(e){
			// Do something on upload error
			console.log('Upload Error', e);
		});

		drop.on('uploadEnd', function(){
			// Do something on upload end
			console.log('Upload Ended', this.xhrResponse);
		});

		// ================================================================================
		// DROPZONE 2

		var dropSecond = new Dropzone('.js-second-dropzone-holder', {
			uploadUrl: 'http://daidalos.apiary.io/image-block/image/upload',
			// renderMethod: 'before', 
			tokens: {
		        // tokenInstanceId: 'booooo',
		        // tokenInputName: '',
		        // tokenInputMultiple: 'multiple'
		    }
		});
		var stateTemplatesVars2 = {
			'errorState': {
				errorMsg: 'Error msg!'
			},
			'successState': {
				successMsg: 'Success!'
			}
		};
		dropSecond.templateState('successState','<i class="icon-plus"></i><span>{{=it.successMsg}}</span>');
		dropSecond.templateState('errorState','{{=it.errorMsg}}');
		
		// set the values for templates
		
		// show dropzone in DOM using variables
		dropSecond.show(stateTemplatesVars2);

		// update template on visible dropzone but you must set variables too
		dropSecond.templateState('defaultState','<strong>{{=it.defaultMsg}}</strong>', { defaultMsg: 'Ola!' });

		// update multiple teplates in one function of course also with variables
		dropSecond.templateStates({
			'successState': {
				template: '<strong>{{=it.successMsg}}</strong>', 
				data: { successMsg: 'Yahoooo!' }
			},
			'progressState': {
				template: '<div class="progress-bar" style="width:{{=it.percent}}%;"></div>',
				data: { percent: 0 }
			}
		});

	</script>
</body>
</html>